version: 2
jobs:
  checkout:
    working_directory: ~/tmp
    docker:
      - image: circleci/node:10.10.0
    steps:
      - checkout
      - run:
          command: |
            set -eux -o pipefail
            sudo apt-get -qq update
            sudo apt-get install -y awscli
      - deploy:
          name: deploy
          command: |
            if [ "${CIRCLE_BRANCH}" = "S3staticweb" ]; then
             - aws s3 sync /home/ubuntu/S3ContinuousDeploy s3://s3awscd --delete
            else
              echo "Not master branch, dry run only"
            fi
